<!DOCTYPE html>
<html>
<head>
  <title>PyMunin - Python Multigraph Munin Plugins</title>
  <meta charset='utf-8'>
  <meta http-equiv="Content-Language" content="en">
  <meta name="description" content="PyMunin - Python Module for Munin Multigraph Monitoring Plugins. Plugins for Apache, Tomcat, Asterisk, Disk I/O, Disk Usage, FreeSWITCH, Memcached, MySQL, Network Interfaces, Network Connections, Nginx, NTP, PHP APC, PHP FPM, PostgreSQL, System CPU and Memory Utilization, VM Paging and Swapping, etc.">
  <meta name="keywords" content="PyMunin, Munin, Plugin, Python, Multigraph, Monitoring, Apache, Tomcat, PHP, APC, FPM, Asterisk, FreeSWITCH, Memcached, MySQL, Network, Interfaces, Connections, Nginx, NTP, PostgreSQL, System, CPU, Memory, Disk Usage, Disk I/O, Processes, Forks, Interrupts">
  <link href="style.css" rel="stylesheet" type="text/css">
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-23944587-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script type="text/javascript" src="./js/tabber.js"></script>
</head>

<body>
  
  <div id="container">

    <div class="download">
      <a href="http://github.com/aouyar/PyMunin">
        <img border="0" src="./img/github.png" alt="GitHub"></a>
      <a href="http://github.com/aouyar/PyMunin/zipball/master">
        <img border="0" height="60" src="http://github.com/images/modules/download/zip.png"
        alt="ZIP Download">
      </a>
      <a href="http://github.com/aouyar/PyMunin/tarball/master">
        <img border="0" height="60" src="http://github.com/images/modules/download/tar.png"
        alt="TAR Download">
      </a>
    </div>

    <h1><a href="http://aouyar.github.com/PyMunin">PyMunin</a>
      <span class="small">by <a href="http://aouyar.github.com">aouyar</a></span></h1>

    <div class="description">
	    <p>PyMunin: Python Module for developing Munin Multigraph Monitoring Plugins.

	    <p>Multigraph Plugins for Apache Web Server, Apache Tomcat, 
	      APC PHP Cache, PHP FPM (Fast Process Manager), Asterisk, FreeSWITCH, 
	      Memcached, MySQL Database, Nginx, NTP, PostgreSQL Database, 
	      CPU Utilization, Memory Utilization, Disk Usage, Disk I/O, 
	      Network Interfaces, Processes and Threads, etc.
	      
    </div>
    
    <div class="tabber">
    	
    	<div class="tabbertab">
	    <h2>Updates</h2>
	    <p>
	    <table summary="Updates" cellpadding=10px>
	    	<tr>
	    		<td valign=top><b>Feb 27, 2012</b></td>
	    		<td valign=top>
	    			Code overhaul to support subgraphs thanks to testing and 
	    			troubleshooting by
	    			<a href="https://github.com/derek-veit">derek-veit (Derek Veit)</a>.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>Feb 15, 2012</b></td>
	    		<td valign=top>
	    			Updated the installation script to fix <i>Python 2.4</i> 
	    			compatibility issue. <i>PyMunin</i> must be easily 
	    			installable on <i>RHEL5</i> now.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>January 26, 2012</b></td>
	    		<td valign=top>
	    			Updated the documentation for the project to facilitate
	    			installation and configuration of the plugins and the
	    			development of new plugins based on <i>PyMunin</i>.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>January 22, 2012</b></td>
	    		<td valign=top>
	    			Thanks to contributions by 
	    			<a href="https://github.com/mlavin">lavin (Mark Lavin)</a> 
	    			<i>PyMunin</i> is much more easier to install; the updated 
	    			code is pip installable and is published in <i>PyPI</i>.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>November 28, 2011</b></td>
	    		<td valign=top>
	    			Added graph for monitoring number of connections to server
	    			ports to <i>netstats</i> plugin. Refactoring of 
	    			<i>netstat</i> and processes modules to move common code to 
	    			<i>util</i> module.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>November 27, 2011</b></td>
	    		<td valign=top>
	    			Added graph for monitoring average requests per handled 
	    			connections to <i>Nginx Plugin</i>.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>October 12, 2011</b></td>
	    		<td valign=top>
	    			Implemented plugin for <i>Process</i> and 
	    			<i>Thread Stats</i>.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>October 7, 2011</b></td>
	    		<td valign=top>
	    			Implemented Fax Stats graph in <i>Asterisk</i> plugin.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>October 6, 2011</b></td>
	    		<td valign=top>
	    			Implemented Queue Stats graphs in <i>Asterisk</i> plugin.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>October 3, 2011</b></td>
	    		<td valign=top>
	    			Added sample graphs for Disk Usage, Disk I/O, 
	    			System Resources and <i>PostgreSQL</i> plugins.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>September 7, 2011</b></td>
	    		<td valign=top>
	    			Added code in pysysinfo for parsing <i>Asterisk</i> queue 
	    			and fax stats.<br>
	    			Pending development of plugins for monitoring queues 
	    			and fax.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>August 30, 2011</b></td>
	    		<td valign=top>
	    			Updated <i>Asterisk</i> plugin. The channel types included 
	    			in the channels graph is now configurable.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>August 29, 2011</b></td>
	    		<td valign=top>
	    			Updated <i>Asterisk</i> plugin. The codec list for graphing VoIP
	    			channel usage is now configurable.
	    		</td>
	    	</tr>
	    	<tr>
	    		<td valign=top><b>August 28, 2011</b></td>
	    		<td valign=top>
	    			Added bgwriter block write stats graph to <i>PostgreSQL</i> 
	    			plugin.
	    		</td>	
	    	</tr>
	    	<tr>
	    		<td valign=top><b>August 26, 2011</b></td>
	    		<td valign=top>
	    			Added checkpoints graph to <i>PostgreSQL</i> plugin.
	    		</td>	
	    	</tr>
	    	<tr>
	    		<td valign=top><b>August 22, 2011</b></td>
	    		<td valign=top>
	    			Added sample graphs for <i>memcached</i> plugin to docs.<br>
	    			Added vlabels to all graphs in <i>memcached</i> plugin.
	    		</td>	
	    	</tr>
	    </table>
	    </div>
    
	    <div class="tabbertab">
	    <h2>About</h2>
	    <p>
	    Regular Munin Plugins employ one-plugin one-graph logic and require the 
	    execution of a script for data retrieval for each graph.
	    Multigraph plugins permit retrieval of data for multiple graphs in one 
	    execution run one-plugin many-graphs), reducing the processing time and 
	    delay for the fetch cycle significantly.
	    More information on Multigraph Plugins can be found in the 
	    <a href="http://munin-monitoring.org/wiki/">Munin Wiki</a>:
	    <ul>
	      <li><a href="http://munin-monitoring.org/wiki/MultigraphSampleOutput">Multigraph Plugins</a>
	      <li><a href="http://munin-monitoring.org/wiki/protocol-multigraph">Multigraph Plugin Protocol</a>
	    </ul>
		
		<p>
		<i>PyMunin</i> has been developed for implementing <i>Multigraph Plugins</i> 
		using <i>Python</i>, but simple single graph plugins are also supported.
		
		<p>The code for retrieval of data is totally separated from Munin 
		specific code. The modules for data retrieval in <i>./pysysinfo</i> can
		be used independently of <i>Munin</i> in other monitoring solutions.
		
	    <h2>License</h2>
	    <p>
	    PyMunin is copyrighted free software made available under the terms of the 
	    GPL License Version 3 or later.
	    See the file COPYING that acompanies the code for full licensing information.

		<h2>Credits</h2>
	    <p><i>PyMunin</i> has been developed by 
	    	<a href="https://github.com/aouyar">aouyar</a> (Ali Onur Uyar).
	    <p>Some of the people that have knowingly or unknowingly contributed 
	    with the development are:
	    <ul>
	    	<li>Initial packaging of the code was done 
	    		by <a href="https://github.com/mlavin">mlavin</a>) (Mark Lavin).
	    		PyMunin is installable pip or easy_install thanks to Mark. :-)
	    	</li>
	    	<li>The initial design of the solution was inspired
	    		by <a href="https://github.com/samuel/python-munin">python-munin</a> 
	    		by <a href="https://github.com/samuel">samuel</a> (Samuel Stauffer).		
	    	</li>
	    	<li>Many plugins were inspired by existing <i>Munin Plugins</i>
	    		developed by other people. (Before developing any plugins, I
	    		always try to check existing solutions.)
	    	</li>
	    </ul>
	    
	    <p>I hope that more people will be using <i>PyMunin</i> for developing
	    plugins in the future.

	    </div>
	    
	    <div class="tabbertab">
	    <h2>Plugins</h2>
	    
	    <p>The following plugins are distributed with <i>PyMunin</i>:
	    <ul>
	      <li><a href="./plugins/tomcat.html">Apache Tomcat Server</a>
	      <li><a href="./plugins/apache.html">Apache Web Server</a>
	      <li><a href="./plugins/asterisk.html">Asterisk Telephony Server</a>
	      <li><a href="./plugins/diskusage.html">Disk Space Usage</a>
	      <li><a href="./plugins/diskio.html">Disk I/O</a>
	      <li><a href="./plugins/freeswitch.html">FreeSWITCH Soft Switch</a>
	      <li><a href="./plugins/memcached.html">Memcached Cache Server</a>
	      <li><a href="./plugins/mysql.html">MySQL Database Server</a>
	      <li><a href="./plugins/netiface.html">Network Interfaces</a>
	      <li><a href="./plugins/netstats.html">Network Connections</a>
	      <li><a href="./plugins/nginx.html">Nginx Web Server</a>
	      <li><a href="./plugins/ntp.html">NTP - Time Synchronization Server</a>
	      <li><a href="./plugins/phpapc.html">PHP APC (PHP Cache)</a>
	      <li><a href="./plugins/phpfpm.html">PHP FPM (FastCGI Process Manager)</a>
	      <li><a href="./plugins/postgresql.html">PostgreSQL Database Server</a>
	      <li><a href="./plugins/process.html">Processes and Threads</a>
	      <li><a href="./plugins/system.html">System Resources</a>
	      <li><a href="./plugins/wanpipe.html">Sangoma Wanpipe Telephony Interfaces</a>
	    </ul>
	    </div>
	    
	    <div class="tabbertab">
	    <h2>Download</h2>
	    <p>
	    New versions of the code are be published for download at 
	    <a href="http://pypi.python.org/pypi/PyMunin">PyPI - the Python Package Index</a>
	    periodically.
	    <p>
	    You can download the latest development version of this code in either
	    <a href="http://github.com/aouyar/PyMunin/zipball/master">zip</a> or
	    <a href="http://github.com/aouyar/PyMunin/tarball/master">tar</a> formats.
	    <p>
	    You can also get the latest development version of the code by cloning the  
	    <a href="http://git-scm.com">Git</a>
	    repository for the project by running:
	    <pre>git clone git://github.com/aouyar/PyMunin</pre>
	    </div>
	    
	    <div class="tabbertab">
	    <h2>Installation</h2>
	    
	    <h3>Automated Installation</h3>
	    <p>
	    The code can be downloaded and installed automatically using 
	    <a href="http://www.pip-installer.org/">pip</a> or
	    the user can download and uncompress the code and execute the 
	    the included <i>setup.py</i> script for installation:
	    <ul>
	    	<li>To install the latest version published in 
	    		<a href="http://pypi.python.org/pypi/PyMunin">PyPI - the Python Package Index</a>
	    		using <a href="http://www.pip-installer.org/">pip</a> execute:
	    		<pre>pip install PyMunin</pre>
	    	</li>
	    	<li>To install the latest development version using 
	    		<a href="http://www.pip-installer.org/">pip</a> execute::
	    		<pre>pip install git+https://github.com/aouyar/PyMunin.git#egg=PyMunin</pre>
	    	</li>
	    	<li>To install using the <i>setup.py</i> script included in the
	    		distribution once the code is downloaded and uncompressed:
			    <pre>./setup.py install</pre>
			</li>
	    </ul>
	     
	    This will install _pymunin_ and _pysysinfo_ in <i>Python</i> site packages.
	    The plugins will be unpacked as console scripts into the install <i>bin</i>
		directory. Each of the scripts will be prefixed with <i>pymunin-</i> 
		(i.e. pymunin-apachestats) to avoid name collisions with other binaries.
		The location will be <i>/usr/local/bin/</i> if installed globally or 
		<i>$VIRTUAL_ENV/bin</i> if installed with 
		<a href="http://www.virtualenv.org/">virtualenv</a>.
		<p>
		The plugins will automatically be installed in 
		<i>Munin Plugins</i> directory (<i>/usr/share/munin/plugins</i>)
		if the installation process is executed with a privileged user and the 
		<i>pymunin-</i> prefix will be dropped in the process. (The location 
		will be <i>$VIRTUAL_ENV/share/munin/plugins</i> if 
		installed with <a href="http://www.virtualenv.org/">virtualenv</a>.)
		<p> If the installation process fails while copying the plugin scripts 
		to <i>Munin Plugin Directory</i> because of permissions problems
		<i>pymunin-install</i> script will be  created for copying the plugins 
		from the <i>bin</i> directory to <i>/usr/share/munin/plugins</i>.
	    
	    <h3>Manual Installation</h3>
	    <h4>Installation of the Libraries</h4>
	    <ul>
		   <li>The <i>./pysysinfo</i> directory should be placed in 
		   	   <i>Python</i> search path or in the <i>Munin Plugins</i> 
		   	   directory (<i>/usr/share/munin/plugins</i>).
		  <li>The <i>./pymunin</i> directory should be placed in 
		  	  <i>Python</i> search path or in the <i>Munin Plugins</i> 
		  	  directory (<i>/usr/share/munin/plugins</i>).
	    </ul>
	   	<h4>Installation of the Plugins</h4>
		<ul>
			<li>Copy the plugin scripts in the directory <i>./pymunin/plugins</i> to 
				the <i>Munin Plugins</i> directory 
				(ex. <i>/usr/share/munin/plugins</i>) after removing the 
				file extension '<i>py</i>'.
		</ul>
		</div>
		
		<div class="tabbertab">
		<h2>Configuration</h2>
		<p>
		<h3>Activating the Plugins</h3>
		<p>Enable the plugins just like the standard plugins by creating 
		symbolic links in the <i>Munin Plugins Configuration Directory</i> 
		(<i>/etc/munin/plugins</i>).
		<h3>Configuration of the Plugins</h3>
		<p>
		Configuration files for plugins can be created in the 
		<i>Munin Plugins Configuration Directory</i> 
		(<i>/etc/munin/plugin-conf.d</i>).
		<p>
		The environment variables used by the plugin scripts are documented in 
		the header part of the plugin modules in <i>./pymunin/plugins</i>.
		</div>
	
		<div class="tabbertab">
		<h2>Troubleshooting</h2>
		<p>
		On error plugins return short error messages by default. Plugin 
		debugging must be enabled to return full trace for exceptions.
		<p>
		Use <i>munin-run</i> with the <i>--pidebug</i> option to enable plugin 
		debugging.
		</div>
		
		<div class="tabbertab">
		<h2>Collaboration</h2>
	    <p>
	    I would be happy to receive suggestions on improving the code for 
	    developing Munin Plugins. You can use the <i>Issues</i> functionality of 
	    <i>GitHub</i> to document problems and to propose improvements. 
	    Alternatively you can use the internal messaging system of <i>GitHub</i> 
	    or my e-mail address to contact me directly.
	    <p>
	    I hope that by sharing the code, the existing plugins will get more 
	    testing and receive improvements, and many more Multigraph Munin Plugins 
	    will be developed collaboratively.
	    <p>
	    I would be glad to receive some sample graphs from anyone using the 
	    plugins.
	    </div>
	    
	    <div class="tabbertab">
	    <h2>Development</h2>
	    <h3>Design</h3>
	    <p>
	    The plugins consist of the following components:
	    <ul>
	    	<li>The <i>pymunin</i> module <i>(./plugins/pymunin)</i> implements the base 
	    		classes for developing Munin plugins.
	    		<ul>
	    			<li>Munin Plugins can be created by subclassing the
	    				<i>MuninPlugin</i> Class.
	    			<li>Each plugin contains one or more graphs implemented by 
	    				<i>MuninGraph</i> Class instances.
	    			<li>The <i>muninMain</i> function implements the entry point for 
	    				Munin Plugins.
	    		</ul>
	    	<li>The plugin logic is implemented in the plugin scripts in 
	    		<i>./plugins</i>.
	    	<li>The actual data retrieval logic is separated from the plugins to 
	    		facilitate code reuse. Individual modules in the directory 
	    		<i>./pysysinfo</i> implement classes for getting the monitoring 
	    		data and returning them as dictionary objects. The separation of 
	    		the data retrieval logic should facilitate the use of the code 
	    		in other monitoring solutions.
	    	<li>Common utility classes and methods used by various data 
	    		retrieval modules are placed in the util module in
	    		<i>./pysysinfo</i>. 
	    </ul>
	    <h3>Plugin Development</h3>
	    <p>
	    The first step for implementing a new <i>Multigraph Munin Plugin</i> is 
	    developing a new module in <i>./pysysinfo</i> for retrieving the 
	    monitoring data.
	    <p>
		The steps for developing the actual plugin script are as follows:
		<ul>
			<li>Plugin scripts are placed in <i>./pymunin/plugins</i> by 
				default.
			<li>New plugins are implemented by extending the <i>MuninPlugin</i> 
				class in <i>./pymunin</i>. You can check the plugin scripts in
				<i>./pymunin/plugins</i> for working examples.
			<li>The <i>plugin_name</i> property of <i>MuninPlugin</i> class 
				must be set to the name of the plugin.
			<li>Graph Objects are registered to the plugin in the constructor 
				of the plugin class.
			<li>Code for creating graph objects which are instances of the 
				<i>MuninGraph</i> class are placed in the constructor of the 
				plugin class.
			<li>Code for adding fields to the graph using the <i>addField</i> 
				method of <i>MuninGraph</i> class is placed in the constructor 
				of the plugin class.
			<li>The <i>retrieveVals</i> method of the plugin class is 
				overwritten to retrieve data points and to associate values with 
				the graph fields using the <i>setGraphVal</i> method of the
				<i>MuninPlugin</i> class.
			<li>The <i>muninMain</i> function in <i>./plugins/pymunin</i> is 
				called with the plugin class as argument for initializing the 
				main method of plugin.
	  	</ul>
	  	</div>
	  	
    </div>

  </div>

  <div class="footer">
     get the source code on GitHub : 
     <a href="http://github.com/aouyar/PyMunin">aouyar/PyMunin</a>
  </div>
  
</body>
</html>
